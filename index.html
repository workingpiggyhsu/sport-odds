<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>è³ ç‡æ›ç®—èˆ‡è¨ˆç®—å°å·¥å…· Odds Calculator (v1.15)</title>
<style>
  :root { color-scheme: light dark; }
  * , *::before, *::after { box-sizing: border-box; }
  html, body { height: 100%; }
  body {
    margin: 0;
    font-family: "Microsoft JhengHei","Noto Sans TC",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans",sans-serif;
    background: linear-gradient(to bottom, #fafafa, #ffffff);
    color: #111;
    -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
  }
  /* Dark scheme */
  @media (prefers-color-scheme: dark) {
    body { background: linear-gradient(to bottom, #0a0a0a, #111); color: #fff; }
    .card, .label, .muted, .formula, .btn { color: #fff; }
    .card { background: rgba(28,28,32,0.78); border-color: rgba(255,255,255,0.14); }
    .muted { color: #e5e7eb; }
    select, input { background: #17171c; color: #fff !important; border-color: #3f3f46; }
    select option { color: #fff; background:#17171c; }
    .btn { border-color: #3f3f46; background: #202026; }
    .btn.active { background: #f4f4f5; color: #0b0b0b; }
  }
  .container { max-width: 1120px; margin: 0 auto; padding: 24px; }
  h1 { font-size: 28px; margin: 0 0 8px; font-weight: 800; letter-spacing: -0.02em; }
  h1 .sub { font-size: 18px; color: #6b7280; font-weight: 600; }
  p.desc { margin: 0 0 24px; color: #4b5563; }
  @media (prefers-color-scheme: dark) { p.desc { color: #c0c2c7; } h1 .sub { color: #a0a4ad; } }
  .grid { display: grid; gap: 16px; align-items: stretch; }
  @media (min-width: 900px) { .grid.cols-3 { grid-template-columns: repeat(3, minmax(0,1fr));} .grid.cols-2 { grid-template-columns: repeat(2, minmax(0,1fr)); } }
  .card {
    display: flex; flex-direction: column; justify-content: flex-start;
    border: 1px solid rgba(0,0,0,0.1); border-radius: 16px; padding: 16px;
    background: rgba(255,255,255,0.92);
    box-shadow: 0 6px 20px rgba(0,0,0,0.06);
    backdrop-filter: blur(4px);
    color:#111;
  }
  .label { font-size: 13px; font-weight: 700; margin-bottom: 8px; color: #111; letter-spacing: .2px;}
  .muted { color: #333; font-size: 12px; }
  /* Wine theme tiles */
  .soft {
    background: linear-gradient(135deg, rgba(120,0,40,0.92), rgba(150,22,55,0.92));
    border-radius: 12px; padding: 12px; border:1px solid #7f1d1d; color:#fff;
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.06), 0 6px 14px rgba(127,29,29,0.15);
  }
  .soft .muted { color: #ffe4e6; opacity: .9; }
  .row { display: grid; grid-template-columns: 1fr auto; gap: 8px; margin: 6px 0; font-size: 14px; }
  .right { text-align: right; font-weight: 800; letter-spacing: .3px; }
  .btn { padding: 8px 14px; border: 1px solid #0b0b0b; border-radius: 999px; background: #f6f7f9; cursor: pointer; font-weight: 700; color:#111;}
  .btn.active { background: #0b0b0b; color: #fff; }
  input, select { width: 100%; padding: 12px 14px; border-radius: 12px; border: 1px solid #d1d5db; font-size: 14px; box-shadow: inset 0 1px 1px rgba(0,0,0,0.03); color:#111; }
  input::placeholder { color: #6b7280; }
  .field { margin-bottom: 10px; }
  .pill { display: inline-block; padding: 2px 8px; border-radius: 999px; background: #eef2f7; font-size: 12px; margin-right: 6px; border: 1px solid #e2e8f0; color:#111; }
  @media (prefers-color-scheme: dark){ .pill{ background:#2a2a33; border-color:#3c3c47; color:#f4f4f5;} }
  .formula { border: 1px solid rgba(0,0,0,0.08); border-radius: 12px; padding: 12px; background: #111; color:#fff; }
  /* Footer notes inside cards: force black text for clarity on light card bg */
  .footer { font-size: 12px; margin-top: 16px; }
  .card .footer, .card .footer li, .card .footer ul li, .card .footer strong { color: #000 !important; }
  .footer ul { margin:6px 0 0 20px; padding:0; line-height:1.6; }
  .footer li { margin:2px 0; }
  .space { height: 24px; }
  .stack { display: grid; gap: 8px; }
  .inline { display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
</style>
</head>
<body>
  <div class="container">
    <h1>ğŸ“Š è³ ç‡æ›ç®—èˆ‡è¨ˆç®—å°å·¥å…· <span class="sub">Odds Calculator</span></h1>
    <p class="desc">v1.15ï¼šæ•´åˆ Notes é»‘å­—ä¿®æ­£åˆ°å®Œæ•´å·¥å…·ï¼›ä¿ç•™é›™è¦–è§’ã€é…’ç´…ä¸»é¡Œèˆ‡å°æ¯”è¦å‰‡ã€‚</p>

    <div class="grid cols-3">
      <div class="card">
        <div class="field">
          <div class="label">ç›¤å£æ ¼å¼ Odds Format</div>
          <select id="format">
            <option value="EU">æ­æ´²ç›¤ European</option>
            <option value="HK">é¦™æ¸¯ç›¤ Hong Kong</option>
            <option value="Malay">é¦¬ä¾†ç›¤ Malay</option>
            <option value="Indo">å°å°¼ç›¤ Indo</option>
            <option value="US">ç¾åœ‹ç›¤ Moneyline</option>
            <option value="Frac">è‹±åœ‹ç›¤ Fractional</option>
          </select>
        </div>
        <div class="field">
          <div class="label">ç›¤å£æ•¸å€¼ Odds Value</div>
          <input id="oddsValue" placeholder="e.g. 1.94 / -0.97 / +145 æˆ– 4/5" />
        </div>
        <div class="muted">* Fractional ç”¨ a/bï¼›US å¯è¼¸å…¥ +145 æˆ– -160ï¼›Malay/Indo æ”¯æ´æ­£è² ã€‚</div>
      </div>

      <div class="card">
        <div class="field">
          <div class="label">è¼¸å…¥æ¨¡å¼ Input Mode</div>
          <div class="inline" style="margin-bottom:6px;">
            <button class="btn active" id="btnStake">æŠ¼æ³¨é‡‘ Stake</button>
            <button class="btn" id="btnToWin">æ¬²è´é‡‘ To-Win</button>
          </div>
        </div>
        <div class="field">
          <div class="label" id="amountLabel">æŠ¼æ³¨é‡‘ Stake (S)</div>
          <input id="amount" placeholder="e.g. 100" />
        </div>
        <div class="muted">* è² æ•¸é¦¬ä¾†/å°å°¼ç›¤å¸¸è¦‹ä»¥ã€Œæ¬²è´é‡‘ã€è¼¸å…¥ï¼›æ­¤è™•å…©ç¨®æ¨¡å¼çš†æ”¯æ´ä¸”æœƒè‡ªå‹•æ›ç®—ã€‚</div>
      </div>

      <div class="card">
        <div class="field">
          <div class="label">è¦–è§’ Formula Perspective</div>
          <div class="inline">
            <button class="btn active" id="perspHK">äºæ´²ç®—æ³•ï¼ˆHKï¼‰</button>
            <button class="btn" id="perspUS">ç¾å¼ç®—æ³•ï¼ˆUSï¼‰</button>
          </div>
        </div>
        <div class="label">çµæœ Results</div>
        <div class="row"><div class="muted">HKï¼ˆæ¯ 1 å–®ä½ç›ˆåˆ© / profit per 1ï¼‰</div><div class="right" id="resHK">-</div></div>
        <div class="row"><div class="muted">æŠ¼æ³¨é‡‘ Stake (S)</div><div class="right" id="resStake">-</div></div>
        <div class="row"><div class="muted">ç›ˆåˆ© Profit</div><div class="right" id="resProfit">-</div></div>
        <div class="row"><div class="muted">æ´¾å½© Payout</div><div class="right" id="resPayout">-</div></div>
      </div>
    </div>

    <div class="space"></div>

    <div class="card">
      <div class="label">ç›¤å£æ›ç®— Conversions</div>
      <div class="grid cols-3">
        <div class="soft stack"><div class="muted">æ­æ´²ç›¤ European (EU)</div><div id="convEU" style="font-weight:900;font-size:18px; letter-spacing:.2px">-</div></div>
        <div class="soft stack"><div class="muted">é¦™æ¸¯ç›¤ Hong Kong (HK)</div><div id="convHK" style="font-weight:900;font-size:18px; letter-spacing:.2px">-</div></div>
        <div class="soft stack"><div class="muted">é¦¬ä¾†ç›¤ Malay</div><div id="convMalay" style="font-weight:900;font-size:18px; letter-spacing:.2px">-</div></div>
        <div class="soft stack"><div class="muted">å°å°¼ç›¤ Indo</div><div id="convIndo" style="font-weight:900;font-size:18px; letter-spacing:.2px">-</div></div>
        <div class="soft stack"><div class="muted">ç¾åœ‹ç›¤ Moneyline (US)</div><div id="convUS" style="font-weight:900;font-size:18px; letter-spacing:.2px">-</div></div>
        <div class="soft stack"><div class="muted">è‹±åœ‹ç›¤ Fractional</div><div id="convFrac" style="font-weight:900;font-size:18px; letter-spacing:.2px">-</div></div>
      </div>
      <div class="muted" id="convNote" style="margin-top:8px"></div>
    </div>

    <div class="space"></div>

    <div class="card">
      <div class="label">è¨ˆç®—å…¬å¼ï¼ˆä¸­è‹±ï¼‰ Formulas</div>
      <div class="grid cols-2" id="formulaGrid"></div>
      <div class="footer">
        <strong>HK ç‚ºæ¯ 1 å–®ä½æŠ•æ³¨å¯ç²å¾—çš„ã€Œç›ˆåˆ©ã€å€æ•¸ï¼ˆä¸å«æœ¬é‡‘ï¼‰ï¼š</strong>
        <ul>
          <li><strong>EU æ­æ´²ç›¤</strong>ï¼šEU = HK + 1</li>
          <li><strong>Malay é¦¬ä¾†ç›¤</strong>ï¼š
            <ul>
              <li>HK â‰¤ 1 â†’ +HK</li>
              <li>HK > 1 â†’ -1/HK</li>
            </ul>
          </li>
          <li><strong>Indo å°å°¼ç›¤</strong>ï¼š
            <ul>
              <li>HK â‰¥ 1 â†’ +HK</li>
              <li>HK < 1 â†’ -1/HK</li>
            </ul>
          </li>
          <li><strong>US ç¾åœ‹ç›¤</strong>ï¼š
            <ul>
              <li>HK â‰¥ 1 â†’ +100 Ã— HK</li>
              <li>HK < 1 â†’ -100/HK</li>
            </ul>
          </li>
          <li><strong>Frac è‹±åœ‹ç›¤</strong>ï¼šHK ä»¥æœ€ç°¡åˆ†æ•¸é¡¯ç¤º</li>
        </ul>
      </div>
    </div>

    <div class="space"></div>

    <div class="card">
      <div class="label">è®Šæ•¸å°ç…§ Glossary (Variables)</div>
      <div class="grid cols-3">
        <div class="soft"><div><span class="pill">S</span> <strong>æŠ¼æ³¨é‡‘ Stake</strong></div><div class="muted">ä¸‹å–®æ™‚å¯¦éš›æ‰£æ¬¾çš„é‡‘é¡ / Amount risked at bet placement.</div></div>
        <div class="soft"><div><span class="pill">W</span> <strong>æ¬²è´é‡‘ To-Win</strong></div><div class="muted">å¸Œæœ›è´å¾—çš„æ·¨åˆ© / Desired net profit target.</div></div>
        <div class="soft"><div><span class="pill">HK</span> <strong>æ¯ 1 å–®ä½ç›ˆåˆ© Profit per 1</strong></div><div class="muted">ä¸å«æœ¬é‡‘ / Excluding stake.</div></div>
      </div>
    </div>

    <div class="footer">âš ï¸ æé†’ï¼šä¸åŒå¹³å°å››æ¨äº”å…¥è¦å‰‡å¯èƒ½ä¸åŒï¼›æ­¤å·¥å…·ç‚ºæ•™å­¸ç”¨é€”ã€‚Rounding may vary across platforms; this tool is for training purposes.</div>
  </div>

<script>
// --- Utilities ---
function clampDecimals(n, digits = 2) {
  if (!isFinite(n)) return "-";
  const factor = Math.pow(10, digits);
  return (Math.round(n * factor) / factor).toFixed(digits);
}
function parseNumber(val) {
  if (val === null || val === undefined) return NaN;
  const n = Number(String(val).trim());
  return isNaN(n) ? NaN : n;
}
function toFraction(x, maxDen = 1000) {
  if (!isFinite(x) || x <= 0) return null;
  let h1 = 1, h2 = 0, k1 = 0, k2 = 1, b = x;
  while (true) {
    const a = Math.floor(b);
    const h = a * h1 + h2;
    const k = a * k1 + k2;
    if (k > maxDen) break;
    h2 = h1; h1 = h; k2 = k1; k1 = k;
    const frac = b - a;
    if (frac === 0) break;
    b = 1 / frac;
  }
  return { num: h1, den: k1 };
}
// format -> HK
function toHK(format, value) {
  switch (format) {
    case "EU": {
      const eu = parseNumber(value);
      if (!(eu > 1)) return NaN;
      return eu - 1;
    }
    case "HK": {
      const hk = parseNumber(value);
      return hk > 0 ? hk : NaN;
    }
    case "Malay": {
      const m = parseNumber(value);
      if (!isFinite(m)) return NaN;
      return m >= 0 ? m : 1 / Math.abs(m);
    }
    case "Indo": {
      const i = parseNumber(value);
      if (!isFinite(i)) return NaN;
      return i >= 0 ? i : 1 / Math.abs(i);
    }
    case "US": {
      const u = parseNumber(value);
      if (!isFinite(u) || u === 0) return NaN;
      return u > 0 ? u / 100 : 100 / Math.abs(u);
    }
    case "Frac": {
      const s = String(value).trim();
      const parts = s.split("/");
      if (parts.length !== 2) return NaN;
      const a = parseNumber(parts[0]);
      const b = parseNumber(parts[1]);
      if (!(a > 0 && b > 0)) return NaN;
      return a / b;
    }
    default: return NaN;
  }
}
// HK -> others
function fromHK(hk) {
  if (!(hk > 0)) return null;
  const EU = hk + 1;
  const HK = hk;
  const Malay = hk <= 1 ? +hk : -1 / hk;
  const Indo = hk >= 1 ? +hk : -1 / hk;
  const US = hk >= 1 ? +(100 * hk) : +(-100 / hk);
  const frac = toFraction(hk);
  const Frac = frac ? `${frac.num}/${frac.den}` : "-";
  return { EU, HK, Malay, Indo, US, Frac };
}
// settlement by HK core
function settleByHK(hk, mode, inputAmount) {
  if (!(hk > 0)) return { stake: NaN, toWin: NaN, profit: NaN, payout: NaN };
  const hkNum = hk;
  if (mode === "stake") {
    const S = Math.max(0, parseNumber(inputAmount));
    const profit = S * hkNum;
    const payout = S + profit;
    return { stake: S, toWin: profit, profit, payout };
  } else {
    const W = Math.max(0, parseNumber(inputAmount));
    const stake = W / hkNum;
    const payout = stake + W;
    return { stake, toWin: W, profit: W, payout };
  }
}
function buildFormulaBlocks(format, hk, rawValue, stake, toWin, mode, perspective) {
  const S = clampDecimals(stake);
  const W = clampDecimals(toWin);
  const HKv = clampDecimals(hk);
  const conv = fromHK(hk);
  const USv = conv ? conv.US : null;
  const blocks = [];
  if (perspective === "HK") {
    blocks.push({ title: "äºæ´²ç®—æ³•ï¼ˆHK è¦–è§’ï¼‰",
      cn: `ç›ˆåˆ© Profit = æŠ¼æ³¨é‡‘ Stake Ã— HK = ${S} Ã— ${HKv}`,
      en: `Profit = Stake Ã— HK = ${S} Ã— ${HKv}` });
    blocks.push({ title: "æ´¾å½©ï¼ˆHK è¦–è§’ï¼‰/ Payout",
      cn: `æ´¾å½© Payout = Stake Ã— (1 + HK) = ${S} Ã— (1 + ${HKv})`,
      en: `Payout = Stake Ã— (1 + HK) = ${S} Ã— (1 + ${HKv})` });
  } else if (perspective === "US" && USv !== null) {
    const usShown = USv > 0 ? "+" + clampDecimals(USv) : clampDecimals(USv);
    if (USv >= 0) {
      blocks.push({ title: `ç¾å¼ç®—æ³•ï¼ˆUS è¦–è§’ï¼š${usShown}ï¼‰`,
        cn: `ç›ˆåˆ© Profit = Stake Ã— (US/100) = ${S} Ã— (${clampDecimals(USv)}/100)`,
        en: `Profit = Stake Ã— (US/100) = ${S} Ã— (${clampDecimals(USv)}/100)` });
      blocks.push({ title: "æ´¾å½©ï¼ˆUS è¦–è§’ï¼‰/ Payout",
        cn: `æ´¾å½© Payout = Stake + Profit = ${S} + ${S} Ã— (${clampDecimals(USv)}/100)`,
        en: `Payout = Stake + Profit = ${S} + ${S} Ã— (${clampDecimals(USv)}/100)` });
    } else {
      const abs = clampDecimals(Math.abs(USv));
      blocks.push({ title: `ç¾å¼ç®—æ³•ï¼ˆUS è¦–è§’ï¼š${usShown}ï¼‰`,
        cn: `ç›ˆåˆ© Profit = Stake Ã— (100/|US|) = ${S} Ã— (100/${abs})`,
        en: `Profit = Stake Ã— (100/|US|) = ${S} Ã— (100/${abs})` });
      blocks.push({ title: "æ´¾å½©ï¼ˆUS è¦–è§’ï¼‰/ Payout",
        cn: `æ´¾å½© Payout = Stake + Profit = ${S} + ${S} Ã— (100/${abs})`,
        en: `Payout = Stake + Profit = ${S} + ${S} Ã— (100/${abs})` });
    }
  }
  // Format-specific explanations
  if (format === "EU") {
    const eu = clampDecimals(parseNumber(rawValue));
    blocks.push({ title: "æ­æ´²ç›¤ / European Odds",
      cn: `æ´¾å½© Payout = Stake Ã— EU = ${S} Ã— ${eu}`,
      en: `Payout = Stake Ã— EU = ${S} Ã— ${eu}` });
  } else if (format === "HK") {
    const hkS = clampDecimals(parseNumber(rawValue));
    blocks.push({ title: "é¦™æ¸¯ç›¤ / Hong Kong Odds",
      cn: `ç›ˆåˆ© Profit = Stake Ã— HK = ${S} Ã— ${hkS}`,
      en: `Profit = Stake Ã— HK = ${S} Ã— ${hkS}` });
  } else if (format === "Malay") {
    const m = parseNumber(rawValue);
    if (isFinite(m)) {
      if (m >= 0) {
        blocks.push({ title: "é¦¬ä¾†ç›¤ï¼ˆæ­£ï¼‰/ Malay (Positive)",
          cn: `ç›ˆåˆ© Profit = Stake Ã— m = ${S} Ã— ${clampDecimals(m)}`,
          en: `Profit = Stake Ã— m = ${S} Ã— ${clampDecimals(m)}` });
      } else {
        const abs = clampDecimals(Math.abs(m));
        if (mode === "stake") {
          blocks.push({ title: "é¦¬ä¾†ç›¤ï¼ˆè² ï¼ŒæŠ¼æ³¨é‡‘ï¼‰/ Malay (Negative, Stake Mode)",
            cn: `ç›ˆåˆ© Profit = Stake Ã· |m| = ${S} Ã· ${abs}`,
            en: `Profit = Stake Ã· |m| = ${S} Ã· ${abs}` });
        } else {
          blocks.push({ title: "é¦¬ä¾†ç›¤ï¼ˆè² ï¼Œæ¬²è´é‡‘ï¼‰/ Malay (Negative, To-Win Mode)",
            cn: `é¢¨éšªé‡‘ Risk = To-Win Ã— |m| = ${W} Ã— ${abs}`,
            en: `Risk = To-Win Ã— |m| = ${W} Ã— ${abs}` });
        }
      }
    }
  } else if (format === "Indo") {
    const i = parseNumber(rawValue);
    if (isFinite(i)) {
      if (i >= 0) {
        blocks.push({ title: "å°å°¼ç›¤ï¼ˆæ­£ï¼‰/ Indo (Positive)",
          cn: `ç›ˆåˆ© Profit = Stake Ã— i = ${S} Ã— ${clampDecimals(i)}`,
          en: `Profit = Stake Ã— i = ${S} Ã— ${clampDecimals(i)}` });
      } else {
        const abs = clampDecimals(Math.abs(i));
        if (mode === "stake") {
          blocks.push({ title: "å°å°¼ç›¤ï¼ˆè² ï¼ŒæŠ¼æ³¨é‡‘ï¼‰/ Indo (Negative, Stake Mode)",
            cn: `ç›ˆåˆ© Profit = Stake Ã· |i| = ${S} Ã· ${abs}`,
            en: `Profit = Stake Ã· |i| = ${S} Ã· ${abs}` });
        } else {
          blocks.push({ title: "å°å°¼ç›¤ï¼ˆè² ï¼Œæ¬²è´é‡‘ï¼‰/ Indo (Negative, To-Win Mode)",
            cn: `é¢¨éšªé‡‘ Risk = To-Win Ã— |i| = ${W} Ã— ${abs}`,
            en: `Risk = To-Win Ã— |i| = ${W} Ã— ${abs}` });
        }
      }
    }
  } else if (format === "US") {
    const u = parseNumber(rawValue);
    if (isFinite(u) && u !== 0) {
      if (u > 0) {
        blocks.push({ title: "ç¾åœ‹ç›¤ï¼ˆæ­£ï¼‰/ Moneyline (Positive)",
          cn: "ç›ˆåˆ© Profit (on $100) = US/100 Ã— 100 â†’ Profit = Stake Ã— (US/100)",
          en: "Profit (on $100) = US/100 Ã— 100 â†’ Profit = Stake Ã— (US/100)" });
      } else {
        blocks.push({ title: "ç¾åœ‹ç›¤ï¼ˆè² ï¼‰/ Moneyline (Negative)",
          cn: "è´$100éœ€æŠ• |US|ï¼›ä¸€èˆ¬åŒ– Profit = Stake Ã— (100/|US|)",
          en: "Need to risk |US| to win $100; generalized Profit = Stake Ã— (100/|US|)" });
      }
    }
  } else if (format === "Frac") {
    blocks.push({ title: "è‹±åœ‹ç›¤ / Fractional Odds",
      cn: "ç›ˆåˆ© Profit = Stake Ã— (åˆ†å­/åˆ†æ¯) = Stake Ã— HKï¼ˆHK = åˆ†å­/åˆ†æ¯ï¼‰",
      en: "Profit = Stake Ã— (numerator/denominator) = Stake Ã— HK (HK = num/den)" });
  }
  return blocks;
}
// DOM wiring
const $ = (id) => document.getElementById(id);
const els = {
  format: $("format"), oddsValue: $("oddsValue"),
  btnStake: $("btnStake"), btnToWin: $("btnToWin"),
  amountLabel: $("amountLabel"), amount: $("amount"),
  perspHK: $("perspHK"), perspUS: $("perspUS"),
  resHK: $("resHK"), resStake: $("resStake"),
  resProfit: $("resProfit"), resPayout: $("resPayout"),
  convEU: $("convEU"), convHK: $("convHK"),
  convMalay: $("convMalay"), convIndo: $("convIndo"),
  convUS: $("convUS"), convFrac: $("convFrac"),
  convNote: $("convNote"), formulaGrid: $("formulaGrid"),
};
let mode = "stake"; let perspective = "HK";
function render() {
  const format = els.format.value;
  const oddsValue = els.oddsValue.value.trim();
  const amount = els.amount.value.trim();
  const hk = toHK(format, oddsValue);
  if (isFinite(hk) && hk > 0) {
    els.resHK.textContent = clampDecimals(hk);
    const st = settleByHK(hk, mode, amount);
    els.resStake.textContent = clampDecimals(st.stake);
    els.resProfit.textContent = clampDecimals(st.profit);
    els.resPayout.textContent = clampDecimals(st.payout);
    const conv = fromHK(hk);
    els.convEU.textContent = clampDecimals(conv.EU);
    els.convHK.textContent = clampDecimals(conv.HK);
    els.convMalay.textContent = clampDecimals(conv.Malay);
    els.convIndo.textContent = clampDecimals(conv.Indo);
    els.convUS.textContent = conv.US > 0 ? "+" + clampDecimals(conv.US) : clampDecimals(conv.US);
    els.convFrac.textContent = conv.Frac;
    els.convNote.textContent = "";
    const blocks = buildFormulaBlocks(format, hk, oddsValue, st.stake, st.toWin, mode, perspective);
    els.formulaGrid.innerHTML = "";
    blocks.forEach((b) => {
      const div = document.createElement("div");
      div.className = "formula";
      div.innerHTML = `<div style="font-weight:800;margin-bottom:6px">${b.title}</div>
        <div style="font-size:14px;line-height:1.7">
          <div>ğŸ‡¨ğŸ‡³ ${b.cn}</div>
          <div>ğŸ‡¬ğŸ‡§ ${b.en}</div>
        </div>`;
      els.formulaGrid.appendChild(div);
    });
  } else {
    [els.resHK, els.resStake, els.resProfit, els.resPayout,
     els.convEU, els.convHK, els.convMalay, els.convIndo, els.convUS, els.convFrac]
     .forEach(el => el.textContent = "-");
    els.convNote.textContent = "è«‹è¼¸å…¥æœ‰æ•ˆç›¤å£æ•¸å€¼ Enter a valid odds value.";
    els.formulaGrid.innerHTML = "";
  }
}
function bind() {
  els.btnStake.addEventListener("click", () => {
    mode = "stake";
    els.btnStake.classList.add("active");
    els.btnToWin.classList.remove("active");
    els.amountLabel.textContent = "æŠ¼æ³¨é‡‘ Stake (S)";
    render();
  });
  els.btnToWin.addEventListener("click", () => {
    mode = "towin";
    els.btnToWin.classList.add("active");
    els.btnStake.classList.remove("active");
    els.amountLabel.textContent = "æ¬²è´é‡‘ To-Win (W)";
    render();
  });
  els.perspHK.addEventListener("click", () => {
    perspective = "HK";
    els.perspHK.classList.add("active");
    els.perspUS.classList.remove("active");
    render();
  });
  els.perspUS.addEventListener("click", () => {
    perspective = "US";
    els.perspUS.classList.add("active");
    els.perspHK.classList.remove("active");
    render();
  });
  ["input","change"].forEach(evt => {
    els.format.addEventListener(evt, () => {
      const def = { EU: "1.94", HK: "0.94", Malay: "0.87", Indo: "1.42", US: "+145", Frac: "4/5" };
      els.oddsValue.value = def[els.format.value] || "1.94";
      render();
    });
    els.oddsValue.addEventListener(evt, render);
    els.amount.addEventListener(evt, render);
  });
}
function init() {
  els.format.value = "EU";
  els.oddsValue.value = "1.94";
  els.amount.value = "100";
  bind();
  render();
}
document.addEventListener("DOMContentLoaded", init);
</script>
</body>
</html>
