<!DOCTYPE html>
<html lang="zh-Hant" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fancy Bet 計算器（Indian Odds）</title>
  <style>
    :root{
      /* dark */
      --bg:#0f1117; --panel:#161b22; --card:#0f131a; --input:#0c1016;
      --line:#243042; --text:#e9eef5; --muted:#98a2b3; --thead:#111726;
      --blue:#4da3ff; --pink:#ff79c6; --green:#38d89c; --red:#ff6b6b; --amber:#ffbf69;
    }
    [data-theme="light"]{
      --bg:#f6f7fb; --panel:#ffffff; --card:#ffffff; --input:#ffffff;
      --line:#e4e7ec; --text:#101828; --muted:#667085; --thead:#eef2f7;
      --blue:#2563eb; --pink:#c026d3; --green:#039855; --red:#d92d20; --amber:#b54708;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);
      font-family:"Noto Sans TC","Microsoft JhengHei","PingFang TC",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      line-height:1.55;}
    header{padding:22px 16px 6px}
    h1{margin:0 0 4px;font-weight:800;letter-spacing:.2px}
    .sub{color:var(--muted);font-size:14px;display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .wrap{max-width:1100px;margin:0 auto;padding:12px 16px 28px}
    .card{background:var(--panel);border:1px solid var(--line);border-radius:14px;padding:16px;box-shadow:0 10px 28px rgb(0 0 0 / .12)}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .right{margin-left:auto}
    label.small{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}
    input,select,button{border-radius:10px;padding:10px 12px;border:1px solid var(--line);background:var(--input);color:var(--text);outline:none}
    input[type="number"]{width:120px}
    button{cursor:pointer;background:#1a2233;transition:.15s;border-color:#2a3448}
    button:hover{transform:translateY(-1px);box-shadow:0 6px 14px rgb(0 0 0 / .12)}
    .btn-primary{background:linear-gradient(135deg,#355cff,#8e76ff);border:none;color:#fff}
    .btn-danger{background:linear-gradient(135deg,#ff5a5a,#ff7a7a);border:none;color:#fff}
    .tabs{display:flex;gap:8px;margin-bottom:10px;flex-wrap:wrap}
    .tab{padding:10px 14px;border-radius:999px;border:1px solid var(--line);cursor:pointer;font-weight:700;background:#0f1522;color:var(--text)}
    .tab.active{background:#1b2434;box-shadow:inset 0 0 0 1px rgba(64,80,114,.6)}
    table{width:100%;border-collapse:separate;border-spacing:0}
    thead th{position:sticky;top:0;z-index:1;background:var(--thead);
      color:#7b8aab;font-weight:700;text-align:left;font-size:13px;padding:10px;border-bottom:1px solid var(--line)}
    tbody td{padding:8px 10px;border-bottom:1px dashed var(--line);vertical-align:middle}
    tr:last-child td{border-bottom:0}
    .grid{overflow:auto;border:1px solid var(--line);border-radius:12px}
    .num{font-variant-numeric:tabular-nums}
    .sum{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:10px;margin-top:12px}
    .box{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:12px}
    .box h4{margin:0 0 6px;color:#7b8aab;font-size:13px}
    .val{font-size:22px;font-weight:800}
    .pos{color:var(--green)} .neg{color:var(--red)}
    details{border:1px solid var(--line);border-radius:12px;padding:10px 12px;background:var(--card)}
    details+details{margin-top:8px}
    details summary{cursor:pointer;font-weight:800;letter-spacing:.2px}
    .muted{color:var(--muted)}
    .pill{display:inline-block;padding:4px 10px;border-radius:999px;font-weight:700;font-size:12px}
    .pill.y{background:#183a1f;color:#8df2b5;border:1px solid #2e6d3d}
    .pill.n{background:#402020;color:#ffb3b3;border:1px solid #6d3030}
    .panel{display:none}
    .panel.active{display:block}
    @media(max-width:880px){
      .sum{grid-template-columns:1fr}
      input[type="number"]{width:100%}
    }
  </style>
</head>
<body>
  <header class="wrap">
    <h1>Fancy Bet 計算器（Indian Odds）</h1>
    <div class="sub">
      <span>支援：<b>分數線 YES/NO</b> 與 <b>一般 YES/NO</b>。含「等於線」處理、淺/深色主題。</span>
      <span class="right"></span>
      <button id="theme" title="切換深色/淺色">切換為淺色</button>
    </div>
  </header>

  <main class="wrap card">
    <div class="tabs" role="tablist">
      <button class="tab active" data-tab="runs">分數線 YES/NO</button>
      <button class="tab" data-tab="basic">一般 YES/NO</button>
      <button class="tab" data-tab="convert">賠率換算</button>
    </div>

    <!-- RUNS PANEL -->
    <section class="panel active" id="panel-runs">
      <div class="row" style="margin-bottom:8px">
        <span class="pill y">YES：通常＝達到/大於線</span>
        <span class="pill n">NO：通常＝未達/小於線</span>
        <div class="right row">
          <div>
            <label class="small" style="margin-bottom:4px">案例（分數線）</label>
            <select id="runs-presets">
              <option value="none">— 請選擇 —</option>
              <option value="demo">載入示例（一般）</option>
              <option value="big">大賠率示例（128/500 & 128/300）</option>
              <option value="small">小賠率示例（27/110 & 27/90）</option>
            </select>
          </div>
          <button class="btn-danger" id="runs-clear">清空</button>
          <button class="btn" id="runs-add">新增一筆</button>
        </div>
      </div>

      <div class="row" style="margin-bottom:10px">
        <div>
          <label class="small">等於分數線 (=) 時</label>
          <select id="eq-mode">
            <option value="void" selected>作廢退本金</option>
            <option value="yes">算 YES</option>
            <option value="no">算 NO</option>
          </select>
        </div>
        <div>
          <label class="small">顯示小數位數</label>
          <input id="dp" type="number" min="0" max="4" value="2" />
        </div>
      </div>

      <div class="grid">
        <table aria-label="分數線投注表">
          <thead>
            <tr>
              <th>#</th>
              <th>市場名稱</th>
              <th>你的選擇</th>
              <th>分數線（runs）</th>
              <th>印度賠率</th>
              <th>投注額（stake）</th>
              <th>實際結果（runs）</th>
              <th>損益（P/L）</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="runs-rows"></tbody>
        </table>
      </div>

      <div class="sum">
        <div class="box">
          <h4>總損益（合計）</h4>
          <div class="val num" id="runs-total">0.00</div>
        </div>
        <div class="box">
          <h4>贏單數 / 輸單數 / 作廢</h4>
          <div class="val" id="runs-ct">0 / 0 / 0</div>
          <div class="muted">作廢＝依上方「等於線」設定</div>
        </div>
        <div class="box">
          <h4>提示</h4>
          <div class="muted">上方設定只影響 <b>結果=分數線</b> 時的判定；實際以平台規則為準。</div>
        </div>
      </div>
    </section>

    <!-- BASIC YES/NO PANEL -->
    <section class="panel" id="panel-basic">
      <div class="row" style="margin-bottom:8px">
        <span class="pill y">YES = 事件發生</span>
        <span class="pill n">NO = 事件未發生</span>
        <div class="right row">
          <div>
            <label class="small" style="margin-bottom:4px">案例（一般 YES/NO）</label>
            <select id="basic-presets">
              <option value="none">— 請選擇 —</option>
              <option value="demo">載入示例（一般）</option>
              <option value="yn">YES/NO 市場示例（NO 55 / YES 45）</option>
            </select>
          </div>
          <button class="btn-danger" id="basic-clear">清空</button>
          <button class="btn" id="basic-add">新增一筆</button>
        </div>
      </div>

      <div class="grid">
        <table aria-label="一般YES/NO表">
          <thead>
            <tr>
              <th>#</th>
              <th>市場名稱</th>
              <th>你的選擇</th>
              <th>印度賠率</th>
              <th>投注額（stake）</th>
              <th>結果</th>
              <th>損益（P/L）</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="basic-rows"></tbody>
        </table>
      </div>

      <div class="sum">
        <div class="box">
          <h4>總損益（合計）</h4>
          <div class="val num" id="basic-total">0.00</div>
        </div>
        <div class="box">
          <h4>贏單數 / 輸單數</h4>
          <div class="val" id="basic-ct">0 / 0</div>
        </div>
        <div class="box">
          <h4>口訣</h4>
          <div class="muted">盈利 = stake × (odds ÷ 100)；虧損 = stake；十進制 = 1 + odds/100。</div>
        </div>
      </div>
    </section>

    <!-- CONVERTER -->
    <section class="panel" id="panel-convert">
      <div class="row">
        <div>
          <label class="small">印度賠率（Indian）</label>
          <input id="indodds" type="number" step="0.01" min="0" value="100" />
        </div>
        <div>
          <label class="small">十進制賠率（Decimal）</label>
          <input id="decodds" type="number" step="0.01" min="1" value="2.00" />
        </div>
        <div class="row">
          <button class="btn" id="toDec">印度 → 十進制</button>
          <button class="btn" id="toInd">十進制 → 印度</button>
        </div>
      </div>
      <div class="box" style="margin-top:12px">
        <h4>公式</h4>
        <div class="muted">Decimal = 1 + Indian/100；Indian = (Decimal − 1) × 100</div>
      </div>
    </section>

    <!-- 說明（預設收合） -->
    <details style="margin-top:12px">
      <summary>📘 Fancy Bet 規則說明（含「作廢」）</summary>
      <div class="box">
        <h4>什麼是作廢 (void / push)？</h4>
        <p class="muted">這筆注單不算輸贏，本金退回，不收交易所佣金。</p>
        <h4>常見作廢情況</h4>
        <ul class="muted" style="margin:0 0 8px 18px">
          <li><b>結果等於分數線</b>：依規則可設定為作廢 / 算 YES / 算 NO（本工具上方可切換）。</li>
          <li><b>分段未完成</b>：如只打到第8 over 就終止，未成形的分段 Fancy 通常作廢。</li>
          <li><b>對象未上場/條件未成形</b>：例如指定打者未上場。</li>
          <li><b>賽事規則變更</b>：縮局、判無效等導致無法公平結算。</li>
        </ul>
        <h4>計算公式（印度賠率）</h4>
        <ul class="muted" style="margin:0 0 8px 18px">
          <li>盈利 = <code>stake × (odds ÷ 100)</code></li>
          <li>虧損 = <code>stake</code></li>
          <li>十進制 = <code>1 + odds/100</code></li>
        </ul>
        <h4>常見風險</h4>
        <ul class="muted" style="margin:0 0 0 18px">
          <li>沒看 equal 規則 → 以為贏/輸，實際作廢或判另一邊。</li>
          <li>把印度賠率當十進制 → 算錯盈虧。</li>
          <li>忽略最小/最大下注額、或賽事未完成。</li>
        </ul>
      </div>
    </details>
  </main>

  <script>
    const $ = (sel, root=document)=>root.querySelector(sel);
    const $$ = (sel, root=document)=>[...root.querySelectorAll(sel)];
    const THEME_KEY='fancy_theme_v1';
    function applyTheme(t){
      document.documentElement.setAttribute('data-theme', t);
      $('#theme').textContent = (t==='dark')?'切換為淺色':'切換為深色';
    }
    (function initTheme(){
      const saved = localStorage.getItem(THEME_KEY);
      const prefersLight = window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches;
      applyTheme(saved || (prefersLight?'light':'dark'));
      $('#theme').addEventListener('click',()=>{
        const cur = document.documentElement.getAttribute('data-theme') || 'dark';
        const n = cur==='dark'?'light':'dark';
        localStorage.setItem(THEME_KEY,n); applyTheme(n);
      });
    })();

    // Tabs
    $$('.tab').forEach(t=>t.addEventListener('click',()=>{
      $$('.tab').forEach(x=>x.classList.remove('active')); t.classList.add('active');
      $$('.panel').forEach(p=>p.classList.remove('active'));
      $('#panel-'+t.dataset.tab).classList.add('active');
    }));

    const dpEl = $('#dp');
    const fmt = (n)=> (isFinite(n)? n:0).toFixed(Math.max(0, parseInt(dpEl.value)||0));
    const posClass = (el,n)=>{ el.classList.toggle('pos',n>0); el.classList.toggle('neg',n<0); };

    // RUNS rows
    const runsRows = $('#runs-rows');
    function addRunsRow(data={}){
      const tr = document.createElement('tr');

      const tdIdx = document.createElement('td'); tdIdx.className='num'; tr.appendChild(tdIdx);

      const tdName = document.createElement('td');
      const inpName = document.createElement('input'); inpName.placeholder='市場名稱（可留空）'; inpName.value = data.name||'';
      tdName.appendChild(inpName); tr.appendChild(tdName);

      const tdSel = document.createElement('td');
      const sel = document.createElement('select'); sel.innerHTML = '<option value="YES">YES</option><option value="NO">NO</option>';
      sel.value = data.selection||'YES'; tdSel.appendChild(sel); tr.appendChild(tdSel);

      const tdLine = document.createElement('td');
      const inpLine = document.createElement('input'); inpLine.type='number'; inpLine.step='1'; inpLine.value = data.line ?? '';
      tdLine.appendChild(inpLine); tr.appendChild(tdLine);

      const tdOdds = document.createElement('td');
      const inpOdds = document.createElement('input'); inpOdds.type='number'; inpOdds.step='0.01'; inpOdds.min='0';
      inpOdds.value = data.odds ?? ''; tdOdds.appendChild(inpOdds); tr.appendChild(tdOdds);

      const tdStake = document.createElement('td');
      const inpStake = document.createElement('input'); inpStake.type='number'; inpStake.step='0.01'; inpStake.min='0';
      inpStake.value = data.stake ?? ''; tdStake.appendChild(inpStake); tr.appendChild(tdStake);

      const tdResult = document.createElement('td');
      const inpRes = document.createElement('input'); inpRes.type='number'; inpRes.step='1';
      inpRes.value = data.result ?? ''; tdResult.appendChild(inpRes); tr.appendChild(tdResult);

      const tdPL = document.createElement('td'); tdPL.className='num'; tdPL.textContent='0.00'; tr.appendChild(tdPL);

      const tdDel = document.createElement('td');
      const del = document.createElement('button'); del.textContent='刪除'; del.onclick=()=>{ tr.remove(); renumber(runsRows); calcRuns(); };
      tdDel.appendChild(del); tr.appendChild(tdDel);

      [inpName, sel, inpLine, inpOdds, inpStake, inpRes, dpEl, $('#eq-mode')].forEach(el=> el.addEventListener('input', calcRuns));
      runsRows.appendChild(tr); renumber(runsRows); calcRuns();
    }
    function renumber(tbody){ $$( 'tr', tbody).forEach( (tr,i)=> tr.children[0].textContent = i+1 ); }
    function calcRuns(){
      let total=0, win=0, lose=0, voidCt=0;
      const eqMode = $('#eq-mode').value; // void/yes/no
      $$('#runs-rows tr').forEach(tr=>{
        const selection = tr.children[2].querySelector('select').value; // YES/NO
        const line = parseFloat(tr.children[3].querySelector('input').value);
        const odds = parseFloat(tr.children[4].querySelector('input').value);
        const stake = parseFloat(tr.children[5].querySelector('input').value);
        const result = parseFloat(tr.children[6].querySelector('input').value);
        const tdPL = tr.children[7];
        if(!(isFinite(line)&&isFinite(odds)&&isFinite(stake)&&isFinite(result)) || stake<=0 || odds<0){ tdPL.textContent='0.00'; return; }
        let occurred = null;
        if(result === line){
          if(eqMode==='void'){ tdPL.textContent = '0.00'; voidCt++; return; }
          occurred = (eqMode==='yes');
        }else{
          occurred = (result > line); // 「通常：Yes＝大於線」的預設
        }
        let pl = 0;
        if(selection==='YES'){
          pl = occurred ? stake*(odds/100) : -stake;
        }else{ // NO
          pl = occurred ? -stake : stake*(odds/100);
        }
        tdPL.textContent = fmt(pl); posClass(tdPL, pl);
        total += pl; if(pl>0) win++; if(pl<0) lose++;
      });
      $('#runs-total').textContent = fmt(total); posClass($('#runs-total'), total);
      $('#runs-ct').textContent = `${win} / ${lose} / ${voidCt}`;
    }
    $('#runs-add').onclick = ()=> addRunsRow();
    $('#runs-clear').onclick = ()=>{ runsRows.innerHTML=''; calcRuns(); };
    function loadRunsPreset(val){
      runsRows.innerHTML='';
      if(val==='demo'){
        addRunsRow({name:'USGC 10 Over Runs', selection:'NO', line:107, odds:100, stake:100, result:100});
        addRunsRow({name:'USGC 10 Over Runs', selection:'YES', line:109, odds:100, stake:100, result:112});
        addRunsRow({name:'Fall of 3rd WKT', selection:'NO', line:77, odds:110, stake:100, result:65});
        addRunsRow({name:'Fall of 3rd WKT', selection:'YES', line:77, odds:90, stake:100, result:65});
      }else if(val==='big'){
        addRunsRow({name:'10 Over Runs', selection:'NO',  line:128, odds:500, stake:100, result:126});
        addRunsRow({name:'10 Over Runs', selection:'YES', line:128, odds:300, stake:100, result:130});
        addRunsRow({name:'10 Over Runs (equal)', selection:'YES', line:128, odds:300, stake:100, result:128});
      }else if(val==='small'){
        addRunsRow({name:'Over Runs', selection:'NO',  line:27, odds:110, stake:100, result:26});
        addRunsRow({name:'Over Runs', selection:'YES', line:27, odds:90,  stake:100, result:28});
        addRunsRow({name:'Over Runs (equal)', selection:'NO', line:27, odds:110, stake:100, result:27});
      }
    }
    $('#runs-presets').addEventListener('change', (e)=>{
      if(e.target.value!=='none') loadRunsPreset(e.target.value);
    });

    // BASIC rows
    const basicRows = $('#basic-rows');
    function addBasicRow(data={}){
      const tr = document.createElement('tr');

      const tdIdx = document.createElement('td'); tdIdx.className='num'; tr.appendChild(tdIdx);

      const tdName = document.createElement('td');
      const inpName = document.createElement('input'); inpName.placeholder='市場名稱（可留空）'; inpName.value = data.name||'';
      tdName.appendChild(inpName); tr.appendChild(tdName);

      const tdSel = document.createElement('td');
      const sel = document.createElement('select'); sel.innerHTML = '<option value="YES">YES</option><option value="NO">NO</option>';
      sel.value = data.selection||'YES'; tdSel.appendChild(sel); tr.appendChild(tdSel);

      const tdOdds = document.createElement('td');
      const inpOdds = document.createElement('input'); inpOdds.type='number'; inpOdds.step='0.01'; inpOdds.min='0';
      inpOdds.value = data.odds ?? ''; tdOdds.appendChild(inpOdds); tr.appendChild(tdOdds);

      const tdStake = document.createElement('td');
      const inpStake = document.createElement('input'); inpStake.type='number'; inpStake.step='0.01'; inpStake.min='0';
      inpStake.value = data.stake ?? ''; tdStake.appendChild(inpStake); tr.appendChild(tdStake);

      const tdRes = document.createElement('td');
      const selRes = document.createElement('select'); selRes.innerHTML = '<option value="YES">YES</option><option value="NO">NO</option>';
      selRes.value = data.result||'YES'; tdRes.appendChild(selRes); tr.appendChild(tdRes);

      const tdPL = document.createElement('td'); tdPL.className='num'; tdPL.textContent='0.00'; tr.appendChild(tdPL);

      const tdDel = document.createElement('td');
      const del = document.createElement('button'); del.textContent='刪除'; del.onclick=()=>{ tr.remove(); renumber(basicRows); calcBasic(); };
      tdDel.appendChild(del); tr.appendChild(tdDel);

      [inpName, sel, inpOdds, inpStake, selRes, dpEl].forEach(el=> el.addEventListener('input', calcBasic));
      basicRows.appendChild(tr); renumber(basicRows); calcBasic();
    }
    function calcBasic(){
      let total=0, win=0, lose=0;
      $$('#basic-rows tr').forEach(tr=>{
        const selection = tr.children[2].querySelector('select').value;
        const odds = parseFloat(tr.children[3].querySelector('input').value);
        const stake = parseFloat(tr.children[4].querySelector('input').value);
        const result = tr.children[5].querySelector('select').value;
        const tdPL = tr.children[6];
        if(!(isFinite(odds)&&isFinite(stake)) || stake<=0 || odds<0){ tdPL.textContent='0.00'; return; }
        const correct = (selection === result);
        const pl = correct ? stake*(odds/100) : -stake;
        tdPL.textContent = fmt(pl); posClass(tdPL, pl);
        total += pl; if(pl>0) win++; if(pl<0) lose++;
      });
      $('#basic-total').textContent = fmt(total); posClass($('#basic-total'), total);
      $('#basic-ct').textContent = `${win} / ${lose}`;
    }
    $('#basic-add').onclick = ()=> addBasicRow();
    $('#basic-clear').onclick = ()=>{ basicRows.innerHTML=''; calcBasic(); };
    function loadBasicPreset(val){
      basicRows.innerHTML='';
      if(val==='demo'){
        addBasicRow({name:'3rd WKT Caught Out @1', selection:'NO', odds:55, stake:100, result:'NO'});
        addBasicRow({name:'3rd WKT Caught Out @1', selection:'YES', odds:45, stake:100, result:'NO'});
      }else if(val==='yn'){
        addBasicRow({name:'YES-NO 市場示例', selection:'NO', odds:55, stake:100, result:'NO'});
        addBasicRow({name:'YES-NO 市場示例', selection:'YES', odds:45, stake:100, result:'NO'});
      }
    }
    $('#basic-presets').addEventListener('change', (e)=>{
      if(e.target.value!=='none') loadBasicPreset(e.target.value);
    });

    // Converter
    $('#toDec').onclick = ()=>{
      const ind = parseFloat($('#indodds').value);
      if(!(isFinite(ind))){ return; }
      const dec = 1 + ind/100;
      $('#decodds').value = dec.toFixed(2);
    };
    $('#toInd').onclick = ()=>{
      const dec = parseFloat($('#decodds').value);
      if(!(isFinite(dec))){ return; }
      const ind = (dec - 1) * 100;
      $('#indodds').value = ind.toFixed(2);
    };

    // seed
    function renumber(tbody){ $$( 'tr', tbody).forEach( (tr,i)=> tr.children[0].textContent = i+1 ); }
    addRunsRow();
    addBasicRow();
  </script>
</body>
</html>
